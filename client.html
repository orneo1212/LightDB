<!DOCTYPE html>
<title>LightDB Client</title>
<script src="twix.js"></script>

<style>
    .result .resultjson {
        width: 500px;
        height: 200px;
    }
</style>

<div class="url">
    <label>LightDB API</label>
    <input class="apiurl" placeholder="URL" value="http://127.0.0.1:3000/db" />
</div>

<div class="path">
    <label title="like /_users">LightDB API path</label>
    <input class="urlpath" placeholder="URL path" value="" />
</div>

<div class="call">
    <button class="btn callapi">CALL API</button>
</div>

<div class="result">
    <textarea class="resultjson" value=""></textarea>
</div>

<div class="update">
    <button class="btn update">Update</button>
</div>

<script lang="javascript">
    function getURL() {
        return document.querySelector('.url .apiurl').value;
    }
    function getPATH() {
        return document.querySelector('.path .urlpath').value;
    }
    function getDATA() {
        return document.querySelector('.result .resultjson').value;
    }

    document.onreadystatechange = function (evt) {
        document.querySelector('.call .callapi').onclick = function (evt) {
            Twix.get(getPATH(), null, function (obj) {
                if (typeof obj == 'string') obj = JSON.parse(obj)
                document.querySelector('.result .resultjson').value = JSON.stringify(obj, null, 2)
            });
        }

        document.querySelector('.update .btn.update').onclick = function (evt) {
            var data = getDATA();
            Twix.ajax({
                url: getPATH(),
                type: 'put',
                headers: { 'Content-Type': 'application/json' },
                data: data,
                success: function (data) {
                    console.log(data);
                }
            });
        }
    }
</script>